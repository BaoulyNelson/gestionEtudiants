{% extends 'base.html' %}

{% block title %}Mon Profil - FASCH{% endblock %}

{% block authenticated_content %}
<div class="row mb-4">
    <div class="col-12">
        <h2><i class="fas fa-user-circle"></i> Mon Profil</h2>
    </div>
</div>

<div class="row">
    <!-- Colonne photo -->
    <div class="col-md-4">
        <div class="card text-center">
            <div class="card-body">
                {% if user.profile_picture %}
                    <img src="{{ user.profile_picture.url }}" class="rounded-circle mb-3"
                         style="width: 150px; height: 150px; object-fit: cover;">
                {% else %}
                    <div class="rounded-circle bg-primary text-white d-inline-flex align-items-center justify-content-center mb-3"
                         style="width: 150px; height: 150px; font-size: 4rem;">
                        {{ user.first_name.0 }}{{ user.last_name.0 }}
                    </div>
                {% endif %}
                <h4>{{ user.get_full_name }}</h4>
                <p class="text-muted">{{ user.get_role_display }}</p>
            </div>
        </div>
    </div>

    <!-- Colonne édition -->
    <div class="col-md-8">
        <form method="post" enctype="multipart/form-data" class="card">
            {% csrf_token %}
            <div class="card-header">
                <h5><i class="fas fa-edit"></i> Modifier mes informations</h5>
            </div>
            <div class="card-body">
                {{ form.as_p }}
            </div>
            <div class="card-footer text-end">
                <button type="submit" class="btn btn-primary">
                    <i class="fas fa-save"></i> Enregistrer les modifications
                </button>
            </div>
        </form>

        {% if user.is_student %}
        <div class="card mt-3">
            <div class="card-header"><i class="fas fa-graduation-cap"></i> Informations académiques</div>
            <div class="card-body">
                <p><strong>Numéro étudiant :</strong> {{ student.student_number }}</p>
                <p><strong>Email :</strong> {{ user.email }}</p>
                <p><strong>Département :</strong> {{ student.department.name|default:"Non assigné" }}</p>
                <p><strong>Genre :</strong> 
                {% if user.gender == 'F' %}
                    Féminin
                {% elif user.gender == 'M' %}
                    Masculin
                {% else %}
                    Non spécifié
                {% endif %}
                </p>

                <p><strong>Année :</strong> {{ student.get_current_year_display }}</p>
                <p><strong>Date d'inscription :</strong> {{ student.enrollment_date|date:"d/m/Y" }}</p>
            </div>
        </div>
        {% elif user.is_professor %}
        <div class="card mt-3">
            <div class="card-header"><i class="fas fa-chalkboard-teacher"></i> Informations professionnelles</div>
            <div class="card-body">
                <p><strong>ID Professeur :</strong> {{ professor.professor_id }}</p>
                <p><strong>Email :</strong> {{ user.email }}</p>
                <p><strong>Département :</strong> {{ professor.department.name|default:"Non assigné" }}</p>
                <p><strong>Genre :</strong> 
                {% if user.gender == 'F' %}
                    Féminin
                {% elif user.gender == 'M' %}
                    Masculin
                {% else %}
                    Non spécifié
                {% endif %}
                </p>
                <p><strong>Spécialisation :</strong> {{ professor.specialization|default:"Non renseignée" }}</p>
                <p><strong>Date d'embauche :</strong> {{ professor.hire_date|date:"d/m/Y" }}</p>
            </div>
        </div>
        {% endif %}
    </div>
</div>
{% endblock %}
